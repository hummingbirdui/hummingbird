@utility form-control {
  @apply relative inline-flex items-center justify-center transition duration-200 gap-2 appearance-none;
  line-height: var(--btn-line-height, 1.5);
  background-color: var(--input-bg, var(--color-muted));
  color: var(--input-content, var(--color-default-color));
  font-size: var(--btn-font-size, var(--text-sm));
  border-radius: var(--btn-radius, var(--radius-lg));
  box-shadow: 0 0 0 1px var(--input-border-color, none);
  padding-left: var(--input-padding-x, calc(var(--hb-spacing) * 4));
  padding-right: var(--input-padding-x, calc(var(--hb-spacing) * 4));
  & :where(input) {
    @apply w-full flex-1 appearance-none;
    padding: var(--btn-padding-y, calc(var(--hb-spacing) * 2)) 0;
  }
  &:not(:has(input)) {
    padding: var(--btn-padding-y, calc(var(--hb-spacing) * 2))
      var(--input-padding-x, calc(var(--hb-spacing) * 4));
  }
  &:is(:disabled, [disabled]),
  &:has(> input[disabled]) {
    --input-bg: var(--input-disabled-bg, var(--color-highlight));
    &:hover {
      --input-bg: var(--input-disabled-bg, var(--color-highlight));
    }
  }

  &:hover {
    --input-bg: var(--input-hover-bg, var(--color-highlight));
  }
  &:focus-within,
  &:focus {
    input,
    textarea {
      @apply outline-0;
    }
    @apply outline-0;
    --input-bg: var(--input-focus-bg, var(--color-primary-lighter));
    --input-border-color: var(--input-focus-border-color, var(--color-primary));
  }
  &.is-invalid {
    --input-bg: var(--color-error-lighter);
    --input-border-color: var(--color-error);
  }
  &[type="file"] {
    overflow: hidden;

    &:not(:disabled):not([readonly]) {
      cursor: pointer;
    }
  }
  &::file-selector-button {
    @apply pointer-events-none transition-[background] duration-200;
    background-color: var(--file-selector-btn-bg, var(--color-highlight));
    color: var(--file-selector-btn-content, var(--color-default-color));
    font-weight: var(--font-weight-semibold);
    padding: var(--btn-padding-y, calc(var(--hb-spacing) * 2))
      var(--btn-padding-x, calc(var(--hb-spacing) * 4));
    margin: calc(-1 * var(--btn-padding-y, calc(var(--hb-spacing) * 2)))
      calc(-1 * var(--btn-padding-x, calc(var(--hb-spacing) * 4)));
    margin-inline-end: var(--input-padding-x, calc(var(--hb-spacing) * 4));
  }
  &:hover:not(:disabled):not([readonly])::file-selector-button {
    --file-selector-btn-bg: var(
      --file-selector-btn-hover-bg,
      var(--color-emphasis)
    );
  }
  &.is-invalid::file-selector-button {
    --file-selector-btn-bg: var(--color-error);
    --file-selector-btn-content: var(--color-contrast);
    --file-selector-btn-hover-bg: var(--color-error-dark);
  }
  &:is(:disabled, [disabled])::file-selector-button {
    --file-selector-btn-bg: var(--color-muted);
  }
}

@utility form-control-outline {
  @apply relative inline-flex items-center justify-center transition duration-200 gap-2 appearance-none;
  line-height: var(--btn-line-height, 1.5);
  color: var(--input-content, var(--color-default-color));
  font-size: var(--btn-font-size, var(--text-sm));
  border-radius: var(--btn-radius, var(--radius-lg));
  box-shadow: 0 0 0 1px var(--input-border-color, var(--color-border-base));
  padding-left: var(--input-padding-x, calc(var(--hb-spacing) * 4));
  padding-right: var(--input-padding-x, calc(var(--hb-spacing) * 4));
  & :where(input) {
    @apply w-full flex-1 appearance-none;
    padding: var(--btn-padding-y, calc(var(--hb-spacing) * 2)) 0;
  }
  &:not(:has(input)) {
    padding: var(--btn-padding-y, calc(var(--hb-spacing) * 2))
      var(--input-padding-x, calc(var(--hb-spacing) * 4));
  }
  &:is(:disabled, [disabled]),
  &:has(> input[disabled]) {
    opacity: 0.5;
    &:hover {
      --input-border-color: var(--color-border-base);
    }
    .form-label {
      --input-label-color: var(--color-disabled);
    }
  }
  &:hover {
    --input-border-color: var(--color-emphasis-color);
  }
  &:focus-within,
  &:focus {
    input,
    textarea {
      @apply outline-0;
    }
    @apply outline-0;
    --input-border-color: var(--input-focus-border-color, var(--color-primary));
  }
  &.is-invalid {
    --input-border-color: var(--color-error);
  }
  &[type="file"] {
    overflow: hidden;

    &:not(:disabled):not([readonly]) {
      cursor: pointer;
    }
  }
  &::file-selector-button {
    @apply pointer-events-none transition-[border] duration-200;
    font-weight: var(--font-weight-semibold);
    padding: var(--btn-padding-y, calc(var(--hb-spacing) * 2))
      var(--btn-padding-x, calc(var(--hb-spacing) * 4));
    margin: calc(-1 * var(--btn-padding-y, calc(var(--hb-spacing) * 2)))
      calc(-1 * var(--btn-padding-x, calc(var(--hb-spacing) * 4)));
    margin-inline-end: var(--input-padding-x, calc(var(--hb-spacing) * 4));
    border-right: 1px solid var(--input-border-color, var(--color-border-base));
  }
}

@utility form-control-icon {
  font-size: 20px;
  color: var(--color-active);
}

@utility form-control-sm {
  --input-padding-x: calc(var(--hb-spacing) * 3);
  --btn-padding-y: calc(var(--hb-spacing) * 1.5);
  --btn-radius: var(--radius-sm);
  --btn-line-height: 1.25;
  .form-control-icon {
    font-size: var(--text-sm);
  }
}
@utility form-control-lg {
  --btn-padding-y: calc(var(--hb-spacing) * 2.5);
  --btn-font-size: var(--text-base);
  .form-control-icon {
    font-size: var(--text-xl);
  }
}
@utility form-control-primary {
  --file-selector-btn-bg: var(--color-primary);
  --file-selector-btn-content: var(--color-contrast);
  --file-selector-btn-hover-bg: var(--color-primary-dark);
}
@utility form-control-secondary {
  --input-focus-bg: var(--color-secondary-lighter);
  --input-focus-border-color: var(--color-secondary);
  --file-selector-btn-bg: var(--color-secondary);
  --file-selector-btn-content: var(--color-contrast);
  --file-selector-btn-hover-bg: var(--color-secondary-dark);
}
@utility form-control-info {
  --input-focus-bg: var(--color-info-lighter);
  --input-focus-border-color: var(--color-info);
  --file-selector-btn-bg: var(--color-info);
  --file-selector-btn-content: var(--color-contrast);
  --file-selector-btn-hover-bg: var(--color-info-dark);
}
@utility form-control-success {
  --input-focus-bg: var(--color-success-lighter);
  --input-focus-border-color: var(--color-success);
  --file-selector-btn-bg: var(--color-success);
  --file-selector-btn-content: var(--color-contrast);
  --file-selector-btn-hover-bg: var(--color-success-dark);
}
@utility form-control-warning {
  --input-focus-bg: var(--color-warning-lighter);
  --input-focus-border-color: var(--color-warning);
  --file-selector-btn-bg: var(--color-warning);
  --file-selector-btn-content: var(--color-contrast);
  --file-selector-btn-hover-bg: var(--color-warning-dark);
}

@utility form-label {
  font-weight: var(--font-weight-medium);
  color: var(--input-label-color, var(--color-highlight-color));
  font-size: var(--text-xs);
}

@utility form-field {
  @apply inline-flex flex-col gap-1;
  &:where(
      :has(
          .form-control,
          .form-control-outline,
          .form-select,
          .form-select-outline
        )
    ):focus-within {
    .form-label {
      --input-label-color: var(--color-primary);
    }
  }
  &:where(:has(.form-control-secondary, .form-select-secondary)):focus-within {
    .form-label {
      --input-label-color: var(--color-secondary);
    }
  }
  &:where(:has(.form-control-info, .form-select-info)):focus-within {
    .form-label {
      --input-label-color: var(--color-info);
    }
  }
  &:where(:has(.form-control-success, .form-select-success)):focus-within {
    .form-label {
      --input-label-color: var(--color-success);
    }
  }
  &:where(:has(.form-control-warning, .form-select-warning)):focus-within {
    .form-label {
      --input-label-color: var(--color-warning);
    }
  }
  &:where(:has(.is-invalid)),
  &:where(:has(.is-invalid)):focus-within {
    .form-label {
      --input-label-color: var(--color-error);
    }
  }
  &:has(input[disabled]) {
    .form-label {
      --input-label-color: var(--color-disabled);
    }
  }
}
